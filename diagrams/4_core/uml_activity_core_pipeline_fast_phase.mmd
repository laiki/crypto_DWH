flowchart TD
    A([Start Fast Phase]) --> B[Resolve paths and validate files]
    B --> C{Inputs valid?}
    C -- No --> C1[Emit setup error]
    C1 --> Z1([Exit code 1])
    C -- Yes --> D[Run build_core_db.py]
    D --> E{Build exit code == 0?}
    E -- No --> E1[Abort fast phase]
    E1 --> Z2([Exit build code])
    E -- Yes --> F[Run core_validation_runner.py]
    F --> F1[Use optional filters kpi_date/run_id]
    F1 --> F2[Enable skip-view-row-counts]
    F2 --> G{Validation exit code == 0?}
    G -- No --> G1[Propagate validation exit code]
    G1 --> Z3([Exit validation code])
    G -- Yes --> H[Print report paths]
    H --> Z4([Exit code 0])
